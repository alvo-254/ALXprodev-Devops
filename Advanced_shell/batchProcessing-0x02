#!/bin/bash
# Task 4 - Retry logic for fetching a Pokémon's data

pokemon="snorlax"
api_url="https://pokeapi.co/api/v2/pokemon/$pokemon"
output_file="${pokemon}.json"
error_file="errors.txt"

max_retries=5
retry_delay=2
attempt=1

while [ $attempt -le $max_retries ]; do
    echo "Attempt $attempt: Fetching data for $pokemon..."
    curl -s "$api_url" -o "$output_file"

    if [ $? -eq 0 ] && [ -s "$output_file" ]; then
        echo "Data for $pokemon fetched successfully ✅"
        exit 0
    else
        echo "Failed to fetch $pokemon on attempt $attempt" >> "$error_file"
        attempt=$((attempt+1))
        sleep $retry_delay
    fi
done

echo "Exceeded maximum retries ($max_retries) for $pokemon" >> "$error_file"
exit 1
